{% extends "base.html" %}

{% block title %}Instructors - Student Management{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-6">
        <h1>Instructors</h1>
    </div>
    <div class="col-md-6 text-end">
        <a href="{{ url_for('instructors.create') }}" class="btn btn-primary btn-hover">+ Add New Instructor</a>
    </div>
</div>

<!-- Search Form -->
<div class="card mb-4 btn-hover">
    <div class="card-body">
        <form method="POST" action="{{ url_for('instructors.search') }}">
            <div class="row">
                <div class="col-md-3">
                    <input type="text" name="instructor_id" class="form-control" placeholder="Instructor ID">
                </div>
                <div class="col-md-3">
                    <input type="text" name="name" class="form-control" placeholder="Full Name">
                </div>
                <div class="col-md-3">
                    <input type="text" name="special" class="form-control" placeholder="Specialization">
                </div>
                <div class="col-md-3">
                    <button type="submit" class="btn btn-info w-100 btn-hover text-white">Search</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Instructors Table -->
<div class="rounded-4">
    {% for instructor in instructors %}
    <div class="card mb-3 w-100 btn-hover">
        <div class="row g-0">
            <div class="col-md-2 p-3 ms-5">
                <img src="{{ url_for('static', filename='images/instructors/1.jpg') }}" class="img-fluid rounded-start">
            </div>
            <div class="col-md-6">
                <div class="card-body">
                    <h5 class="card-title"> <span class="fw-bold">Instructor:</span> {{instructor.full_name}}
                    </h5>
                    <p class="card-text">
                        <span class="fw-bold">ID:</span> {{ instructor.instructor_id }}
                    </p>
                    <p class="card-text">
                        <span class="fw-bold">Email:</span> {{ instructor.email }}
                    </p>

                    <p class="card-text">
                        <span class="fw-bold">Specialization:</span> {{ instructor.specialization }}
                    </p>

                    <p class="card-text">
                        <span class="fw-bold">Office Location:</span> {{ instructor.office_location }}
                    </p>
                    <p class="card-text"><small class="text-body-secondary">Last updated {{ instructor.updated_at
                            }}</small>
                    </p>
                </div>
            </div>
            <div class="col-md-2 d-flex flex-column justify-content-center align-items-center ms-auto">
                <a href="{{ url_for('instructors.update', instructor_id=instructor.instructor_id) }}"
                    class="btn btn-sm btn-warning p-2 m-1 rounded-pill text-white btn-hover"
                    style="width: 70px;">Edit</a>
                <button class="btn btn-sm btn-danger p-2 m-1 rounded-pill text-white btn-hover" style="width: 70px;"
                    onclick=" deleteInstructor('{{ instructor.instructor_id }}')" type="button">Delete</button>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<script>
    function deleteInstructor(id) {
        if (confirm('Are you sure you want to delete this instructor?')) {
            fetch(`/instructors/delete/${id}`, { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        location.reload();
                    } else {
                        alert(data.message);
                    }
                });
        }
    }
</script>
{% endblock %}